---
title: "VIOLENCIA INTRAFAMILIAR EN MEXICO"
output: 
  flexdashboard::flex_dashboard:
     storyboard: true
     theme: united
     logo: R-LadiesGlobal_RBG_online_LogoWithText_Horizontal - copia.png 
     social: ["twitter","instagram"]
---

```{r setup, include=FALSE}
library(flexdashboard)
library(leaflet.extras)
library(leaflet)
library(dplyr)
library(sp)
library(dplyr)
library(tibble)
library(readr)
library(tidyr)
library(ggplot2)
library(gganimate)
library(ggsci)
library(gifski)
library(plotly)
library(tidyverse)
datos <- read_csv("violencia_mexico.csv")
attach(datos)

#Cambiar los NAs por ceros
datos<-datos %>% mutate(Junio = coalesce(Junio, 0))
datos<-datos %>% mutate(Julio = coalesce(Julio, 0))
datos<-datos %>% mutate(Agosto = coalesce(Agosto, 0))
datos<-datos %>% mutate(Septiembre = coalesce(Septiembre, 0))
datos<-datos %>% mutate(Octubre = coalesce(Octubre, 0))
datos<-datos %>% mutate(Noviembre = coalesce(Noviembre, 0))
datos<-datos %>% mutate(Diciembre = coalesce(Diciembre, 0))

#Eliminar los meses que 2020 no tiene registrados
datos$Junio<-NULL
datos$Julio<-NULL
datos$Agosto<-NULL
datos$Septiembre<-NULL
datos$Octubre<-NULL
datos$Noviembre<-NULL
datos$Diciembre<-NULL

#Agregar columna con totales:
datos<-mutate(datos,Total=rowSums(datos[,8:12]))


#Aguascalientes#
AGUASCALIENTES<- datos %>%
  filter(Entidad == "Aguascalientes" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(AGUASCALIENTES)

#Baja California#
BAJA_CALIFORNIA<- datos %>%
  filter(Entidad == "Baja California" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(BAJA_CALIFORNIA)

#Baja California Sur
BAJA_CALIFORNIA_SUR<- datos %>%
  filter(Entidad == "Baja California Sur" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(BAJA_CALIFORNIA_SUR)

#Campeche
CAMPECHE<- datos %>%
  filter(Entidad == "Campeche" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(CAMPECHE)

#Chiapas
CHIAPAS<- datos %>%
  filter(Entidad == "Chiapas" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(CHIAPAS)

#Chihuahua
CHIHUAHUA<- datos %>%
  filter(Entidad == "Chihuahua" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(CHIHUAHUA)

#CdMx
CDMX<- datos %>%
  filter(Entidad == "Ciudad de M�xico" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(CDMX)

#Coahuila
COAHUILA<- datos %>%
  filter(Entidad == "Coahuila de Zaragoza" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(COAHUILA)

#Colima
COLIMA<- datos %>%
  filter(Entidad == "Colima" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(COLIMA)

#Durango
DURANGO<- datos %>%
  filter(Entidad == "Durango" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(DURANGO)

EDOMEX<- datos %>%
  filter(Entidad == "M�xico" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(EDOMEX)

GUANAJUATO<- datos %>%
  filter(Entidad == "Guanajuato" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(GUANAJUATO)

GUERRERO<- datos %>%
  filter(Entidad == "Guerrero" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(GUERRERO)

HIDALGO<- datos %>%
  filter(Entidad == "Hidalgo" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(HIDALGO)

JALISCO<- datos %>%
  filter(Entidad == "Jalisco" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(JALISCO)

MICHOACAN<- datos %>%
  filter(Entidad == "Michoac�n de Ocampo" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(MICHOACAN)

MORELOS<- datos %>%
  filter(Entidad == "Morelos" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(MORELOS)

NAYARIT<- datos %>%
  filter(Entidad == "Nayarit" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(NAYARIT)

NUEVO_LEON<- datos %>%
  filter(Entidad == "Nuevo Le�n" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(NUEVO_LEON)

OAXACA<- datos %>%
  filter(Entidad == "Oaxaca" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(OAXACA)

PUEBLA<- datos %>%
  filter(Entidad == "Puebla" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(PUEBLA)

QUERETARO<- datos %>%
  filter(Entidad == "Quer�taro" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(QUERETARO)

QUINTANA_ROO<- datos %>%
  filter(Entidad == "Quintana Roo" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(QUINTANA_ROO)

SAN_LUIS_POTOSI<- datos %>%
  filter(Entidad == "San Luis Potos�" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(SAN_LUIS_POTOSI)

SINALOA<-datos %>%
  filter(Entidad == "Sinaloa" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(SINALOA)

SONORA<-datos %>%
  filter(Entidad == "Sonora" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(SONORA)

TABASCO<-datos %>%
  filter(Entidad == "Tabasco" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(TABASCO)

TAMAULIPAS<-datos %>%
  filter(Entidad == "Tamaulipas" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(TAMAULIPAS)

TLAXCALA<-datos %>%
  filter(Entidad == "Tlaxcala" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(TLAXCALA)

VERACRUZ<-datos %>%
  filter(Entidad == "Veracruz de Ignacio de la Llave" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(VERACRUZ)

YUCATAN<-datos %>%
  filter(Entidad == "Yucat�n" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(YUCATAN)

ZACATECAS<-datos %>%
  filter(Entidad == "Zacatecas" & Tipo == "Violencia familiar") %>%
  group_by(Entidad)%>%mutate(color1=2*log(Total))
 attach(ZACATECAS)

```
Mis intentos de gráficas
```{r}
#Obtener los datos totales sólo de violencia familiar

Violencia_familiarMx<-datos %>%
  filter(Tipo == "Violencia familiar")

#Graficar datos por año por entidad
ggplot(Violencia_familiarMx, aes(fill=Año, y=Total, x=Entidad)) + 
    geom_bar(position="fill", stat="identity")+ theme(axis.text.x=element_text(angle=90, hjust=1))

ggplot(Violencia_familiarMx, aes(fill=Año, y=Total, x=Entidad)) + 
    geom_bar(position="dodge", stat="identity")+ theme(axis.text.x=element_text(angle=90, hjust=1))

ggplot(Violencia_familiarMx, aes(fill=Entidad, y=Total, x=Año)) + 
    geom_bar(position="stack", stat="identity")

ggplot(Violencia_familiarMx, aes(fill=Entidad, y=Total, x=Año)) + 
    geom_bar(position="dodge", stat="identity")
```


### Gráfica 1: Total de casos reportados por entidad en los primeros 5 meses de 2015 a 2020.

```{r}

fig <- plot_ly(Violencia_familiarMx, x = ~Entidad, y = ~Total, type = 'bar', name = 'Total 2018')#Esto ya no me sale...
fig <- fig %>% add_trace(y = ~TOTAL.2019, name = 'Total 2019')
fig <- fig %>% add_trace(y = ~TOTAL.2020, name = 'Total 2020')
fig <- fig %>% layout(yaxis = list(title = 'Casos totales',type = "log"), barmode = 'stack',
                      hovermode = "compare")
fig

```


### Gráfica 3: Casos reportados por violencia intrafamiliar por año y entidad

```{r}

p <- ggplot(Violencia_familiarMx, aes(Año, Total, color = Entidad, shape=Enero)) +
  geom_point(aes(size = Total, frame = Año)) +
  scale_y_log10()
p
fig3 <- ggplotly(p,tooltip = "all")
fig3
```

***Creo que no tenemos datos sobre municipios en México, pero podriamos hacer el mapa a nivel estatal***
### Mapa: Casos totales por municipios en 2020

```{r}
Col<- leaflet() %>%
  addProviderTiles("OpenStreetMap.HOT")%>%
    addCircleMarkers( data = AMAZONAS, color= "blueviolet", radius = ~color1, lat = AMAZONAS$Lat, lng = AMAZONAS$Lon, 
                    popup = paste0("<b>Nombre del municipio:", 
                                   "</b>",
                                   AMAZONAS$MUNICIPIO,
                                   "<br/>", 
                                   "<b>Cantidad:", 
                                   "</b>",
                                   AMAZONAS$CANTIDAD), group = "Amazonas",clusterOptions = markerClusterOptions()) %>%
    addCircleMarkers(data = ANTIOQUIA , color="blueviolet",radius =~color2, lat = ANTIOQUIA$Lat, lng = ANTIOQUIA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  ANTIOQUIA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  ANTIOQUIA$CANTIDAD), group = "Antioquia",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = ARAUCA, color="blueviolet",radius =~color3, lat = ARAUCA$Lat, lng = ARAUCA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  ARAUCA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  ARAUCA$CANTIDAD), group = "Arauca",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = ATLANTICO, color="blueviolet",radius =~color4, lat = ATLANTICO$Lat, lng = ATLANTICO$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  ATLANTICO$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  ATLANTICO$CANTIDAD), group = "Atlantico",clusterOptions = markerClusterOptions()) %>%
    addCircleMarkers(data = BOLIVAR, color="blueviolet",radius =~color5, lat = BOLIVAR$Lat, lng = BOLIVAR$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  BOLIVAR$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  BOLIVAR$CANTIDAD), group = "Bolivar",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = BOYACA, color="blueviolet",radius =~color6, lat = BOYACA$Lat, lng = BOYACA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  BOYACA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  BOYACA$CANTIDAD), group = "Boyaca",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = CALDAS, color="blueviolet",radius =~color7, lat = CALDAS$Lat, lng = CALDAS$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  CALDAS$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  CALDAS$CANTIDAD), group = "Caldas",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = CAQUETA, color="blueviolet",radius =~color8, lat = CAQUETA$Lat, lng = CAQUETA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  CAQUETA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  CAQUETA$CANTIDAD), group = "Caqueta",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = CASANARE, color="deepskyblue",radius =~color9, lat = CASANARE$Lat, lng = CASANARE$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  CASANARE$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  CASANARE$CANTIDAD), group = "Casanare",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = CAUCA, color="deepskyblue",radius =~color10, lat = CAUCA$Lat, lng = CAUCA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  CAUCA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  CAUCA$CANTIDAD), group = "Cauca",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = CESAR, color="deepskyblue",radius =~color11, lat = CESAR$Lat, lng = CESAR$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  CESAR$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  CESAR$CANTIDAD), group = "Cesar",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = CHOCO, color="deepskyblue",radius =~color12, lat = CHOCO$Lat, lng = CHOCO$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  CHOCO$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  CHOCO$CANTIDAD), group = "Choco",clusterOptions = markerClusterOptions()) %>%
    addCircleMarkers(data = CORDOBA, color="deepskyblue",radius =~color13, lat = CORDOBA$Lat, lng = CORDOBA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  CORDOBA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  CORDOBA$CANTIDAD), group = "Cordoba",clusterOptions = markerClusterOptions()) %>% 
  addCircleMarkers(data = CUNDINAMARCA, color="deepskyblue",radius =~color14, lat = CUNDINAMARCA$Lat, lng = CUNDINAMARCA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  CUNDINAMARCA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  CUNDINAMARCA$CANTIDAD), group = "Cundinamarca",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = GUAINIA, color="blue",radius =~color15, lat = GUAINIA$Lat, lng = GUAINIA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  GUAINIA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  GUAINIA$CANTIDAD), group = "Guainia",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = GUAJIRA, color="blue",radius =~color16, lat = GUAJIRA$Lat, lng = GUAJIRA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  GUAJIRA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  GUAJIRA$CANTIDAD), group = "Guajira",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = GUAVIARE, color="blue",radius =~color17, lat = GUAVIARE$Lat, lng = GUAVIARE$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  GUAVIARE$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  GUAVIARE$CANTIDAD), group = "Guaviare",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = HUILA, color="blue",radius =~color18, lat = HUILA$Lat, lng = HUILA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  HUILA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  HUILA$CANTIDAD), group = "Huila",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = MAGDALENA, color="blue",radius =~color19, lat = MAGDALENA$Lat, lng = MAGDALENA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  MAGDALENA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  MAGDALENA$CANTIDAD), group = "Magdalena",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = META, color="blue",radius =~color20, lat = META$Lat, lng = META$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  META$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  META$CANTIDAD), group = "Meta",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = NARINO, color="blue",radius =~color21, lat = NARINO$Lat, lng = NARINO$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  NARINO$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  NARINO$CANTIDAD), group = "Narino",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = NORTEDESANTANDER, color="blue",radius =~color22, lat = NORTEDESANTANDER$Lat, lng = NORTEDESANTANDER$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  NORTEDESANTANDER$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  NORTEDESANTANDER$CANTIDAD), group = "Norte de Santander",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = PUTUMAYO, color="blue",radius =~color23, lat = PUTUMAYO$Lat, lng = PUTUMAYO$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  PUTUMAYO$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  PUTUMAYO$CANTIDAD), group = "Putumayo",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = QUINDIO, color="blue",radius =~color24, lat = QUINDIO$Lat, lng = QUINDIO$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  QUINDIO$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  QUINDIO$CANTIDAD), group = "Quindio",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = RISARALDA, color="blue",radius =~color25, lat = RISARALDA$Lat, lng = RISARALDA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  RISARALDA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  RISARALDA$CANTIDAD), group = "Risaralda",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = SANANDRES, color="blue",radius =~color26, lat = SANANDRES$Lat, lng = SANANDRES$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  SANANDRES$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  SANANDRES$CANTIDAD), group = "San Andres",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = SANTANDER, color="blue",radius =~color27, lat = SANTANDER$Lat, lng = SANTANDER$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  SANTANDER$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  SANTANDER$CANTIDAD), group = "Santander",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = SUCRE, color="blue",radius =~color28, lat = SUCRE$Lat, lng = SUCRE$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  SUCRE$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  SUCRE$CANTIDAD), group = "Sucre",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = TOLIMA, color="deepskyblue",radius =~color29, lat = TOLIMA$Lat, lng = TOLIMA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  TOLIMA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  TOLIMA$CANTIDAD), group = "Tolima",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = VALLE, color="deepskyblue",radius =~color30, lat = VALLE$Lat, lng = VALLE$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  VALLE$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  VALLE$CANTIDAD), group = "Valle",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = VAUPES, color="deepskyblue",radius =~color30, lat = VAUPES$Lat, lng = VAUPES$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  VAUPES$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  VAUPES$CANTIDAD), group = "Vaupes",clusterOptions = markerClusterOptions()) %>%
  addCircleMarkers(data = VICHADA, color="deepskyblue",radius =~color31, lat = VICHADA$Lat, lng = VICHADA$Lon, 
                   popup = paste0("<b>Nombre del municipio:", 
                                  "</b>",
                                  VICHADA$MUNICIPIO,
                                  "<br/>",
                                  "<b>Cantidad:",
                                  "</b>",
                                  VICHADA$CANTIDAD), group = "Vichada",clusterOptions = markerClusterOptions()) %>%
     addDrawToolbar(targetGroup = 'datos',editOptions = editToolbarOptions(selectedPathOptions = selectedPathOptions()))%>%
  addLayersControl(overlayGroups = c("Amazonas", "Antioquia","Arauca","Atlantico","Bolivar","Boyaca",
                                     "Caldas","Caqueta","Casanare", "Cauca", "Cesar",
                                     "Choco","Cordoba","Cundinamarca","Guainia",
                                     "Guajira","Guaviare","Huila","Magdalena",
                                     "Meta","Narino","Norte de Santander","Putumayo",
                                     "Quindio","Risaralda","San Andres", "Santander",
                                     "Sucre","Tolima", "Valle","Vaupes","Vichada")
    )
Col%>%fitBounds(lng1 =-81.70 ,lat1 = -4.21,lng2 =-67.88 ,lat2 =18.58 )
Col




```

*** TEXTO DE BARRANQUILLA***
En el siguiente mapa se puede observar el numero de casos totales de violencia intrafamiliar reportados por cada uno de los municpios del país. La información que se muestra correspodnde a los meses de Enero, Febrero,Marzo, Abril y Mayo de 2020


**Intento con datos de México... probando sólo con dos estados y no funciona :(  **

```{r}
#Agregar latitud y longitud de cada estado

#¿Hay alguna forma más eficiente de hacer esto?? o quiza no es necesario pero no sé :'(

AGUASCALIENTES<-mutate(AGUASCALIENTES,Lat=21.88234)
AGUASCALIENTES<-mutate(AGUASCALIENTES,Lon=-102.28259)

BAJA_CALIFORNIA<-mutate(BAJA_CALIFORNIA,Lat=32.62781)
BAJA_CALIFORNIA<-mutate(BAJA_CALIFORNIA,Lon=-115.45446)

```
Grafica el número de variables (6) y no la cantidad total de registros...jum

```{r}
Mx<- leaflet() %>%
  addProviderTiles("OpenStreetMap.HOT")%>%
    addCircleMarkers( data = AGUASCALIENTES, color= "blueviolet", lat = AGUASCALIENTES$Lat, lng = AGUASCALIENTES$Lon, 
                    popup = paste0(AGUASCALIENTES$Total)                            , group = "Aguascalientes",clusterOptions = markerClusterOptions()) %>%
    addCircleMarkers(data = BAJA_CALIFORNIA , color="blueviolet", lat = BAJA_CALIFORNIA$Lat, lng = BAJA_CALIFORNIA$Lon, 
                   popup = paste0(BAJA_CALIFORNIA$Total), group = "Baja California",clusterOptions = markerClusterOptions())

Mx

```

```{r}
map<-leaflet() %>%
  
addProviderTiles("Stamen.Toner") %>%
  
setView(-66.105721, 18.466333, zoom = 11) %>%
  
  addMarkers(df$Xlat, df$Ylong, 
             popup = paste("<Strong>Area del Sector Censal</Strong>",df$A, ## Funcion paste() e integracioón con HTML5
                           "</br><Strong>Población 0-15</Strong>",df$G0_15,
                           "</br><Strong>Población 16-64</Strong>",df$G16_64,
                           "</br><Strong>Población 65+</Strong>", df$G65mas,
                           "</br><Strong>Tasa de Dependencia </Strong>",tasaDep,"1",
                           sep=":"))
print(map)
```






